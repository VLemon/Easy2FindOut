# ARC 到底到底是怎么实现

日常写代码离不开ARC，我们天天写Strong ，Weak 这些关键字，也都知道ARC，MRC，但是这两种内存管理之间到底是怎么实现的，以及有什么关系 我想需要整理明确一下。

内存管理 -- 内存种类 管理的主要是那一部分的内存？

## 内存的种类

首先我们的进程在启动的时候操作系统会分配一段内存，除了我们熟知的栈区（stack），堆区（heap）外还有全局区/静态区（static），常量区，代码区。 先说不常用的

### 代码区
* 存放我们app的代码。
* 特点是为了保护代码不被修改 该区域是不允许写操作的。
* 程序结束后自动释放。

### 全局区/静态区
* 主要存放初始化/未初始化的 全局变量以及静态变量。
* 初始化的全局变量以及静态变量在一起 存放在已初始化数据段（.data）,未初始化的存放在未初始化数据段（.bss）
* 同代码区一样，也是程序结束后自动释放


### 栈区

* 栈区的大小在线程创建的时候就已经固定了，比如iOS主线程 栈区大小为512k，我们可以通过NSThead的stackSize方法获取或者设置，但是需要再线程启动之前设置好栈区的大小，所以说主线程的栈大小没办法直接控制。

* 栈区是一种“先进后出”的存储结构，我们常用的方法调用就是一个进栈的过程，方法执行完后出栈，保证了代码的顺序执行，方法中的参数变量（如果是引用类型栈中持有的是指针）也就存放在了栈区，如果方法一直进栈没有出栈的过程，因为我们的栈是有空间限制的就会出现“栈溢出”。

### 堆区



|  |

## MRC
手动内存管理， retain， release， retainCount

